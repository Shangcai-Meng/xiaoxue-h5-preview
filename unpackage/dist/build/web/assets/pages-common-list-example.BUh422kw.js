import{p as a,r as t,m as s,Y as e,X as l,_ as i,a7 as o,b as r,w as n,i as d,o as u,d as c,e as f,u as m,f as p,g as h,F as g,k as _,j as y,E as M,t as b,h as k}from"./index-wgqImcLz.js";import{a as v,b as w}from"./uni-app.es.DBKN6atv.js";import{_ as L}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=L({__name:"list-example",setup(L){const j=function(r,n={}){const d={limit:10,autoLoad:!0,pullDownRefresh:!0,reachBottom:!0,...n},u=a({list:[],page:1,limit:d.limit,hasMore:!0,loading:!1,refreshing:!1,firstLoad:!0,total:0}),c=t(null),f=async(a=!1)=>{if(u.hasMore||a)try{e("加载中..."),u.loading=!0,c.value=null,a&&(u.page=1,u.refreshing=!0);const t=await r({page:u.page,limit:u.limit}),{list:s,total:l}=t.data;u.list=a?s||[]:[...u.list,...s||[]],u.total=l||0,u.hasMore=u.list.length<u.total,u.firstLoad=!1,u.hasMore&&(u.page+=1)}catch(t){c.value=t.message||"加载失败",l(c.value)}finally{i(),u.loading=!1,u.refreshing=!1,a&&o()}},m=()=>f(!0),p=()=>{u.loading||f()};return s(()=>{d.autoLoad&&f()}),d.pullDownRefresh&&v(()=>{m()}),d.reachBottom&&w(()=>{p()}),{state:u,error:c,loadData:f,refresh:m,loadMore:p,reset:()=>{u.list=[],u.page=1,u.hasMore=!0,u.loading=!1,u.refreshing=!1,u.firstLoad=!0,c.value=null}}}(async a=>new Promise(t=>{setTimeout(()=>{const{page:s,limit:e}=a,l=[],i=(s-1)*e,o=Math.min(i+e,35);for(let a=i;a<o;a++)l.push({id:a+1,title:`标题 ${a+1}`,description:`这是第 ${a+1} 条数据的描述信息，可以包含更多详细内容。`,image:`https://picsum.photos/600/400?random=${a+1}`});t({code:200,data:{list:l,total:35,page:s,limit:e}})},500)}),{limit:10,autoLoad:!0,pullDownRefresh:!0,reachBottom:!0});return(a,t)=>{const s=y,e=M,l=d,i=k;return u(),r(l,{class:"list-container"},{default:n(()=>[c(l,{class:"list-header"},{default:n(()=>[c(s,{class:"list-title"},{default:n(()=>[f("列表示例")]),_:1}),c(e,{class:"refresh-btn",onClick:m(j).refresh,disabled:m(j).state.loading},{default:n(()=>[f("刷新")]),_:1},8,["onClick","disabled"])]),_:1}),c(l,{class:"list-content"},{default:n(()=>[(u(!0),p(g,null,h(m(j).state.list,(a,t)=>(u(),r(l,{key:t,class:"list-item"},{default:n(()=>[c(i,{class:"item-image",src:a.image||"https://picsum.photos/600/400",mode:"aspectFill"},null,8,["src"]),c(l,{class:"item-info"},{default:n(()=>[c(s,{class:"item-title"},{default:n(()=>[f(b(a.title),1)]),_:2},1024),c(s,{class:"item-desc"},{default:n(()=>[f(b(a.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),c(l,{class:"loading-status"},{default:n(()=>[m(j).state.loading?(u(),r(l,{key:0,class:"loading"},{default:n(()=>[c(s,null,{default:n(()=>[f("加载中...")]),_:1})]),_:1})):!m(j).state.hasMore&&m(j).state.list.length>0?(u(),r(l,{key:1,class:"no-more"},{default:n(()=>[c(s,null,{default:n(()=>[f("没有更多数据了")]),_:1})]),_:1})):m(j).state.hasMore||0!==m(j).state.list.length?_("",!0):(u(),r(l,{key:2,class:"empty"},{default:n(()=>[c(s,null,{default:n(()=>[f("暂无数据")]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1})}}},[["__scopeId","data-v-b4be3251"]]);export{j as default};
